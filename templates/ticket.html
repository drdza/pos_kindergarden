{% extends "base.html" %}
{% block title %}Ticket {{ sale.folio }}{% endblock %}
{% block content %}
<div class="ticket">
  <h1 style="text-align:center;">{{ sale.folio }}</h1>
  <div>Fecha: {{ sale.created_at }}</div>
  <div>Alumno: {{ sale.customer }}</div>
  <div>Vendedor: {{ sale.seller }}</div>
  <hr/>
  <table>
    <thead><tr><th>Desc</th><th class="right">Cant</th><th class="right">P.Unit</th><th class="right">Impt</th></tr></thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it.description_snapshot }}</td>
        <td class="right">{{ '%.2f'|format(it.qty) }}</td>
        <td class="right">{{ '%.2f'|format(it.unit_price) }}</td>
        <td class="right">{{ '%.2f'|format(it.line_total) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <hr/>
  <div class="row"><div>Subtotal</div><div class="right">{{ '%.2f'|format(sale.subtotal) }}</div></div>
  <div class="row"><div>IVA</div><div class="right">{{ '%.2f'|format(sale.tax_total) }}</div></div>
  <div class="row"><div><strong>Total</strong></div><div class="right"><strong>{{ '%.2f'|format(sale.total) }}</strong></div></div>
  <div class="row"><div>Pagos</div><div class="right">{{ '%.2f'|format(pays|sum(attribute='amount')) }}</div></div>
  <div class="row"><div>Estado</div><div class="right">{{ sale.payment_status }}</div></div>
  <p style="text-align:center; margin-top:10px;">Â¡Gracias por su compra!</p>
</div>

<div class="no-print" style="margin-top:12px;">
  <button class="btn" onclick="window.print()">Imprimir</button>
  <a class="btn secondary" href="{{ url_for('new_sale') }}">Nueva venta</a>
</div>
{% endblock %}
